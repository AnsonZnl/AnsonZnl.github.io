(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{403:function(e,n,a){"use strict";a.r(n);var t=a(43),s=Object(t.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"mongodb-删除语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-删除语句"}},[e._v("#")]),e._v(" MOngoDB  删除语句")]),e._v(" "),a("p",[a("strong",[e._v("delete()删除")])]),e._v(" "),a("ol",[a("li",[e._v("删除一个集合\n"),a("code",[e._v("db.collection.deleteOne()")])]),e._v(" "),a("li",[e._v("删除多个集合\n"),a("code",[e._v("db.collection.deletMany();")])])]),e._v(" "),a("p",[a("strong",[e._v("remove()删除")])]),e._v(" "),a("ol",[a("li",[e._v("删除所有的name：李四的数据\n"),a("code",[e._v('db.student.remove({name:"李四"});')])]),e._v(" "),a("li",[e._v("只删除一条sex:男的数据 仅删除一条\n"),a("code",[e._v('db.student.remove({sex:"男"},true);')])]),e._v(" "),a("li",[e._v("删除全部\n"),a("code",[e._v("db.student.remove({});")])])]),e._v(" "),a("h3",{attrs:{id:"数据库假删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库假删除"}},[e._v("#")]),e._v(" 数据库假删除")]),e._v(" "),a("p",[e._v("有时候用户删除操作的时候，需求是这样的，仅是隐藏这条数据，并不是真的从数据库中删除。\n这时候就用到假删除了，\n比如这个是张三发的两篇微博：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('db.student.insert([\n    {name:"张三",content:"今天心情好",isDel:0},\n    {name:"张三",content:"今天心情一般",isDel:0},\n]);\n')])])]),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-0cf6106c47156b0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"b21d2b7140562e21fcbe9c168e02da9.png"}})]),e._v(" "),a("p",[e._v("用户增加两条数据，但只保留后一条，删除前一条，这时候用到假删除 ，在添加数据时加上一个字段"),a("code",[e._v("isDel:0")]),a("br"),e._v("\n所以当用户删除数据时候 执行的不是remove方法而是update方法")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('db.student.update({"_id" : ObjectId("5bd6a46f1eb7a22fa07cb382")},{\n    $set:{\n      isDel:1\n    }\n});\n')])])]),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-c1ca4b50a635972c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"98cf763807e662cd724e6d65f1638fb.png"}}),e._v("\n当"),a("code",[e._v("isDel:0")]),e._v("是表示用户没有删除 为1是表示用户已经删除")]),e._v(" "),a("p",[e._v("所以在查询的时候要筛选name和isDel条件即可")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('db.student.find({name:"张三",isDel:0});\n')])])]),a("p",[e._v("查询到用户没有删除的数据:")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-a917d02348ba2b6e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"121b7fc4d6f40af1de843359cdbf585.png"}})]),e._v(" "),a("p",[e._v("然后就可以实现假删除了。")]),e._v(" "),a("h3",{attrs:{id:"批量数据的操作和修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量数据的操作和修改"}},[e._v("#")]),e._v(" 批量数据的操作和修改")]),e._v(" "),a("ol",[a("li",[e._v("向集合中插入10000个文档")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("var arr= [];\nfor(var i=0;i<10000;i++){\n   arr.push({counter:i});\n}\ndb.demos.insert(arr);\ndb.demos.find();\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("查询demos中counter为666的文档\n"),a("code",[e._v("db.demos.find({counter:666});")])]),e._v(" "),a("li",[e._v("查询demos中counter小于66的文档\n"),a("code",[e._v("db.demos.find({counter:{$lt:666}});")])]),e._v(" "),a("li",[e._v("查询demos中counter大T666的文档\n"),a("code",[e._v("db.demos.find({counter:{$gt:666}});")])]),e._v(" "),a("li",[e._v("查询demos中counter大于66小于666的文档1120查吉demos集合中的前10余数据\n"),a("code",[e._v("db.demos.find({counter:{$gt:66, $lt:666}});")])]),e._v(" "),a("li",[e._v("查石demos集合中的第1字到20条数据\n"),a("code",[e._v("db.demos.find().limit(10);")])]),e._v(" "),a("li",[e._v("查春demos集合中的第2 1条到30条数据  分页功能   skip从多少条开始 limit每次查询多少条")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("db.demos.find().skip(0).limit(10);//第一页 从0条开始 每查询10条\ndb.demos.find().skip(10).limit(10);//第二页 从10条开始 每查询10条\ndb.demos.find().skip(20).limit(10);//第三页 从20条开始 每查询10条\n\n")])])]),a("h3",{attrs:{id:"集合中文档关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集合中文档关系"}},[e._v("#")]),e._v(" 集合中文档关系")]),e._v(" "),a("ol",[a("li",[e._v("一对一（noe to noe）:\n比如：人和身份证   老公和老婆")]),e._v(" "),a("li",[e._v("一对多（noe to many）:\n比如：父母和孩子  用户和物品")]),e._v(" "),a("li",[e._v("多对多（many to many）:\n比如：老师和学生")])]),e._v(" "),a("h4",{attrs:{id:"一对一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一对一"}},[e._v("#")]),e._v(" 一对一")]),e._v(" "),a("p",[e._v("以内嵌文档的形式体现，")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('//一对一\ndb.aAndb.insert([\n {name:"杨过",wife:{name:"小龙女",sex:"女"},sex:"男"},\n  {name:"杨过",wife:{name:"小龙女",sex:"女"},sex:"男"}\n])\n\ndb.aAndb.find();\n')])])]),a("h4",{attrs:{id:"一对多"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一对多"}},[e._v("#")]),e._v(" 一对多")]),e._v(" "),a("p",[e._v("通过内嵌文档的形式实现或者通过集合的形式实现")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('//一对多  比如  微博 和 微博评论\n//添加微博\ndb.weibo.insert([\n{weibo:"世界这么大，我想去看看"},\n{weibo:"我要做一名web开发者！！！"}\n])\n\ndb.weibo.find();\n')])])]),a("p",[e._v("添加评论")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('db.comments.insert([\n{\nweibo_id: ObjectId("5bdd89e06a5e78f4cfc2b9c8"),\nlist:[\n   "那你有钱吗",\n    "一个人吗？？去呢啊？？",\n    "加油！！"\n]\n},\n{\nweibo_id: ObjectId("5bdd89e06a5e78f4cfc2b9c9"),\nlist:[\n   "那你要学习HTML",\n   "那还要你要学习css",\n    "加油！！"\n]\n}\n]);\n\ndb.comments.find();\n')])])]),a("p",[e._v("查询一对多")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('var weibo_id= db.weibo.findOne({"weibo" : "世界这么大，我想去看看"})._id;\ndb.comments.find({weibo_id: weibo_id});\n')])])]),a("h4",{attrs:{id:"多对多的关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多对多的关系"}},[e._v("#")]),e._v(" 多对多的关系")]),e._v(" "),a("p",[e._v("比如：学生和老师\n可以通过多文档关联，")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('//多对多  老师《------》学生\n\n//插入老师集合\ndb.teachers.insert([\n{\n  name:"语文老师",\n  teacher_id: 1,\n  student_id:[\n     1001,\n     1002,\n     1003\n  ]\n  },\n{\n  name:"数学老师",\n  teacher_id: 2,\n  student_id:[\n     1001,\n     1002,\n     1003\n  ]\n  },\n{\n  name:"英语老师",\n  teacher_id: 3,\n  student_id:[\n     1001,\n     1002,\n     1003\n  ]\n }\n])\n\ndb.teachers.find();\n\n\n//插入学生集合\ndb.students.insert([\n{\n  name:"小明",\n  student_id: 1001,\n  teacher_id:[\n     1,\n     2,\n     3\n  ]\n  },\n{\n  name:"小红",\n  student_id: 1002,\n  teacher_id:[\n     1,\n     2,\n     3\n  ]\n  },\n{\n  name:"小刚",\n  student_id: 1003,\n  teacher_id:[\n     1,\n     2,\n     3\n  ]\n }\n])\n\ndb.students.find();\ndb.teachers.find();\n')])])]),a("h3",{attrs:{id:"排序和索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#排序和索引"}},[e._v("#")]),e._v(" 排序和索引")]),e._v(" "),a("h4",{attrs:{id:"排序："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#排序："}},[e._v("#")]),e._v(" 排序：")]),e._v(" "),a("p",[e._v("查询文档时，默认是按照_id的值进行排序的（升序）\nsort() 可以用来指定文档的排序规则，sort() 内部需要传递一个对象来指定文档的排序规则 ，其中1表示升序 ，-1表示降序\nlimit skip sort 的顺序可以任意改变 ，运行时会自动调整。\n不希望它默认按照id排序  希望它按照工资来排序")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("//按照工资升序排列\n\ndb.section.find().sort({wages:1});\n\n//优先按照工资升序排列  如果遇到相同的就在  按照id升序排列\ndb.section.find().sort({wages: 1},{_id: -1});\n\n")])])]),a("h4",{attrs:{id:"索引："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#索引："}},[e._v("#")]),e._v(" 索引：")]),e._v(" "),a("p",[e._v("展示字段中 部分内容\n或者是提取这个字段内的部分内容\n在查询时 ，可以在第二个参数来设置查询的结果投影")]),e._v(" "),a("blockquote",[a("p",[e._v("索引： find({ 查询条件 }, { 检索范围（1显示 0隐藏）})\n注意： "),a("code",[e._v("_id")]),e._v("如果不设置默认是1（显示） 可手动隐藏")])]),e._v(" "),a("p",[a("code",[e._v("db.section.find({}, {name: 1});")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("//只显示name和wages字段\n`db.section.find({}, {name: 1, _id: 0, wages: 1});`\n")])])]),a("p",[a("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-1b481d1c9381e28f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"a07a1f2945204ef671ddebc28871c00.png"}})])])}),[],!1,null,null,null);n.default=s.exports}}]);