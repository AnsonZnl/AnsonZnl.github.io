(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{376:function(e,s,t){"use strict";t.r(s);var a=t(43),r=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"express框架"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#express框架"}},[e._v("#")]),e._v(" Express框架")]),e._v(" "),t("h3",{attrs:{id:"web-应用程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#web-应用程序"}},[e._v("#")]),e._v(" Web 应用程序")]),e._v(" "),t("p",[e._v("Express 是一个保持最小规模的灵活的 Node.js Web 应用程序开发框架，为 Web 和移动应用程序提供一组强大的功能。")]),e._v(" "),t("h3",{attrs:{id:"api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[e._v("#")]),e._v(" API")]),e._v(" "),t("p",[e._v("使用您所选择的各种 HTTP 实用工具和中间件，快速方便地创建强大的 API。")]),e._v(" "),t("h3",{attrs:{id:"性能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能"}},[e._v("#")]),e._v(" 性能")]),e._v(" "),t("p",[e._v("Express 提供精简的基本 Web 应用程序功能，而不会隐藏您了解和青睐的 Node.js 功能。")]),e._v(" "),t("h2",{attrs:{id:"express-路由基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#express-路由基本使用"}},[e._v("#")]),e._v(" Express-路由基本使用")]),e._v(" "),t("p",[e._v("下载："),t("code",[e._v("npm install express --save")])]),e._v(" "),t("h3",{attrs:{id:"hello-world"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-world"}},[e._v("#")]),e._v(" Hello world")]),e._v(" "),t("p",[e._v("新建一个"),t("code",[e._v("server.js")]),e._v("文件，然后输入：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const express = require('express');\nconst app= express();\n\napp.get('/', (req, res)=>{\n    req.send('Hello world');\n});\napp.listen(8083, ()=>{\n    console.log('Server is running at http://localhost:8083')\n})\n\n")])])]),t("p",[e._v("然后运行："),t("code",[e._v("node server.js")]),e._v("\n打开：http://localhost:8083/\n就出现：\n"),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-b7ae26b3cdafc65a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"11546413582_.pic.jpg"}})]),e._v(" "),t("h3",{attrs:{id:"请求和响应"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#请求和响应"}},[e._v("#")]),e._v(" 请求和响应")]),e._v(" "),t("p",[e._v("Express 应用使用回调函数的参数： request 和 response 对象来处理请求和响应的数据。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("app.get('/', function (request, response) {\n   // --\n})\n")])])]),t("p",[e._v("request 和 response 对象的具体介绍：")]),e._v(" "),t("h3",{attrs:{id:"request-对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#request-对象"}},[e._v("#")]),e._v(" Request 对象")]),e._v(" "),t("blockquote",[t("p",[e._v("request 对象表示 HTTP 请求，包含了请求查询字符串，参数，内容，HTTP 头部等属性。常见属性有：")])]),e._v(" "),t("p",[e._v("req.app：当callback为外部文件时，用req.app访问express的实例\nreq.baseUrl：获取路由当前安装的URL路径\nreq.body / req.cookies：获得「请求主体」/ Cookies\nreq.fresh / req.stale：判断请求是否还「新鲜」\nreq.hostname / req.ip：获取主机名和IP地址\nreq.originalUrl：获取原始请求URL\nreq.params：获取路由的parameters\nreq.path：获取请求路径\nreq.protocol：获取协议类型\nreq.query：获取URL的查询参数串\nreq.route：获取当前匹配的路由\nreq.subdomains：获取子域名\nreq.accepts()：检查可接受的请求的文档类型\nreq.acceptsCharsets / req.acceptsEncodings / req.acceptsLanguages：返回指定字符集的第一个可接受字符编码\nreq.get()：获取指定的HTTP请求头\nreq.is()：判断请求头Content-Type的MIME类型")]),e._v(" "),t("h3",{attrs:{id:"response-对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#response-对象"}},[e._v("#")]),e._v(" Response 对象")]),e._v(" "),t("blockquote",[t("p",[e._v("response 对象表示 HTTP 响应，即在接收到请求时向客户端发送的 HTTP 响应数据。常见属性有：")])]),e._v(" "),t("p",[e._v("res.app：同req.app一样\nres.append()：追加指定HTTP头\nres.set()在res.append()后将重置之前设置的头\nres.cookie(name，value [，option])：设置Cookie\nopition: domain / expires / httpOnly / maxAge / path / secure / signed\nres.clearCookie()：清除Cookie\nres.download()：传送指定路径的文件\nres.get()：返回指定的HTTP头\nres.json()：传送JSON响应\nres.jsonp()：传送JSONP响应\nres.location()：只设置响应的Location HTTP头，不设置状态码或者close response\nres.redirect()：设置响应的Location HTTP头，并且设置状态码302\nres.render(view,[locals],callback)：渲染一个view，同时向callback传递渲染后的字符串，如果在渲染过程中有错误发生next(err)将会被自动调用。callback将会被传入一个可能发生的错误以及渲染后的页面，这样就不会自动输出了。\nres.send()：传送HTTP响应\nres.sendFile(path [，options] [，fn])：传送指定路径的文件 -会自动根据文件extension设定Content-Type\nres.set()：设置HTTP头，传入object可以一次设置多个头\nres.status()：设置HTTP状态码\nres.type()：设置Content-Type的MIME类型")]),e._v(" "),t("h2",{attrs:{id:"express-路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#express-路由"}},[e._v("#")]),e._v(" Express-路由")]),e._v(" "),t("blockquote",[t("p",[e._v("我们已经了解了 HTTP 请求的基本应用，而路由决定了由谁(指定脚本)去响应客户端请求。\n在HTTP请求中，我们可以通过路由提取出请求的URL以及GET/POST参数。")])]),e._v(" "),t("p",[e._v("路由的基本形式：\n"),t("code",[e._v("app.METHOD(PATH, HANDLER)")])]),e._v(" "),t("ol",[t("li",[t("code",[e._v("app")]),e._v(" 表示的是一个Express的实例")]),e._v(" "),t("li",[t("code",[e._v("METHOD")]),e._v(" 是http请求的方法（get, psot..）")]),e._v(" "),t("li",[t("code",[e._v("PATH")]),e._v(" 服务器上的路径")]),e._v(" "),t("li",[t("code",[e._v("HANDLER")]),e._v("请求之后的执行函数")])]),e._v(" "),t("p",[e._v("下面的示例说明了如何定义路由：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// 对/news 页面进行get请求\napp.get('news', (req, res)=>{\n    res.send('Hello news');\n});\n// 对/about 页面进行post请求\napp.post('about', (req, res)=>{\n    res.send('Hello about');\n});\n// 对/list* 可匹配 /list+任意字符\napp.get('/list*', (req, res)=>{\n    res.send('Hello list pages');\n})\n")])])]),t("p",[e._v("然后运行："),t("code",[e._v("node server.js")]),e._v("\n打开："),t("a",{attrs:{href:"http://localhost:8083/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8083/"),t("OutboundLink")],1),e._v(" "),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-b8692b839960c7cf.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"21546417068_.pic.jpg"}}),e._v(" "),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-688f54ceb329ceb1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"31546417103_.pic.jpg"}}),e._v(" "),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-e0af0827093b7ac1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"41546417120_.pic.jpg"}})]),e._v(" "),t("h2",{attrs:{id:"express-搭建静态资源库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#express-搭建静态资源库"}},[e._v("#")]),e._v(" Express-搭建静态资源库")]),e._v(" "),t("blockquote",[t("p",[e._v("Express 提供了内置的中间件 express.static 来设置静态文件如：图片， CSS, JavaScript 等。")])]),e._v(" "),t("p",[e._v("你可以使用 express.static 中间件来设置静态文件路径。例如，如果你将图片， CSS, JavaScript 文件放在 public 目录下，你可以这么写：\n"),t("code",[e._v("app.use(express.static('public'));")])]),e._v(" "),t("p",[e._v("现在，你就可以访问 public 目录中的所有文件了：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("public/index.html\npublic/images\npublic/images/bg.jpeg\npublic/css\n...\n")])])]),t("p",[e._v("如果要使用多个静态资源目录，请多次调用 express.static 中间件函数：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("app.use(express.static('public'))\napp.use(express.static('files'))\n")])])]),t("p",[e._v("Express 在静态目录查找文件，因此，存放静态文件的目录名不会出现在 URL 中。\n但是您可以给静态目录添加一个路由：\n"),t("code",[e._v("app.use('/static', express.static(path.join(__dirname, 'public')))")]),e._v("\n设置"),t("code",[e._v("/static")]),e._v("为"),t("code",[e._v("/public")]),e._v("目录的路由。\n现在，你就可以通过带有 /static 前缀地址来访问 public 目录中的文件了。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://localhost:8083/static/css\nhttp://localhost:8083/static/css/index.css\nhttp://localhost:8083/static/image\nhttp://localhost:8083/static/images/bg.jpeg\nhttp://localhost:8083/static/index.html\n")])])]),t("p",[e._v("为了安全，最好使用绝对路由：\n"),t("code",[e._v("app.use('/static', express.static(path.join(__dirname, 'public')))")]),e._v("\n然后运行："),t("code",[e._v("node server.js")]),e._v("\n打开："),t("a",{attrs:{href:"http://localhost:8083/static",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8083/static"),t("OutboundLink")],1),e._v("\n就可以访问public下的所有文件，如图：\n"),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-8d727856b5ec84a3.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"61546420083_.pic_hd.jpg"}})]),e._v(" "),t("h2",{attrs:{id:"express-模板引擎之ejs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#express-模板引擎之ejs"}},[e._v("#")]),e._v(" Express-模板引擎之EJS")]),e._v(" "),t("blockquote",[t("p",[e._v("EJS 是一套简单的模板语言，帮你利用普通的 JavaScript 代码生成 HTML 页面。")])]),e._v(" "),t("p",[e._v("下载Ejs: "),t("code",[e._v("npm install ejs --save")]),e._v("\n同目录下新建"),t("code",[e._v("myejs.js")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const express= require('express');\nconst app = express();\n//设置模板文件的目录,并且新建一个viwes的目录\napp.set('views', './views');\n//注册模板引擎\napp.set('view engine', 'ejs');\n//使用res.render()来渲染一个视图并将呈现的HTML字符串发送给客户端；\napp.get('/', function(req, res,) {\n    res.render('index', { title: '测试' });\n});\n//监听8083端口\napp.listen(8083, ()=>{\n    console.log('Server is running at http://localhost:8083')\n})\n\n")])])]),t("p",[e._v("在新建views目录中新建index.ejs:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(" <h1><%= title %></h1>\n")])])]),t("p",[e._v("然后运行："),t("code",[e._v("node myejs.js")]),e._v("\n打开："),t("a",{attrs:{href:"http://localhost:8083",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8083"),t("OutboundLink")],1),e._v("\n即可看到：\n"),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-b333856ae590d4e1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:""}})]),e._v(" "),t("p",[e._v("当然，也可以返回一个json文件来渲染视图：\n在同目录下新建一个data.json:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('{\n    "list": [\n    { "name":"小明" , "age":"6", "sex": "男"},\n    { "name":"小红" , "age":"4" ,"sex": "女"},\n    { "name":"小亮" , "age":"5" ,"sex": "男"}\n    ],\n    "source":"神奇二班"\n}\n')])])]),t("p",[e._v("然后更改myejs.js:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const express= require('express');\nconst fs= require('fs');\nconst app = express();\n\n//设置模板文件的目录,并且新建一个viwes的目录\napp.set('views', './views');\n//注册模板引擎\napp.set('view engine', 'ejs');\n//使用res.render()来渲染一个视图并将呈现的HTML字符串发送给客户端；\napp.get('/', function(req, res,) {\n    getDataJson((dataJson)=>{\n        console.log(dataJson);\n        res.render('index', dataJson);\n    })\n});\n//访问data.json 拿到数据解析并返回\nconst getDataJson=(callBack)=>{\n    fs.readFile('./data.json', (err, data)=>{\n        if(!err){\n            let jsonData= JSON.parse(data);\n            callBack(jsonData);\n        }else{\n            throw err;\n        }\n    })\n}\n//监听8083端口\napp.listen(8083, ()=>{\n    console.log('Server is running at http://localhost:8083')\n})\n\n")])])]),t("p",[e._v("然后更改index.ejs:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("<h4><%=source %></h4>\n<ul>\n    <% for(var i=0; i<list.length; i++){ %>\n        <li><%= list[i].name %> | <%= list[i].age %> | <%= list[i].sex %></li>\n    <% } %>    \n</ul>\n")])])]),t("p",[e._v("然后在运行："),t("br"),e._v("\n然后运行："),t("code",[e._v("node myejs.js")]),t("br"),e._v("\n打开："),t("a",{attrs:{href:"http://localhost:8083/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:8083"),t("OutboundLink")],1)]),e._v(" "),t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/7072486-62bf6f8073433d15.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:""}})]),e._v(" "),t("p",[e._v("参考："),t("br"),e._v(" "),t("a",{attrs:{href:"https://github.com/AnsonZnl/StudyNodeJS/tree/master/demo/expressDemo",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub源码"),t("OutboundLink")],1),t("br"),e._v(" "),t("a",{attrs:{href:"http://www.expressjs.com.cn/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Express官方文档"),t("OutboundLink")],1),t("br"),e._v(" "),t("a",{attrs:{href:"https://ejs.bootcss.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("EJS 模板引擎"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);