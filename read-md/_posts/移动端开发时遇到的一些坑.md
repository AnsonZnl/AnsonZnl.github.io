---
title: 移动端开发时遇到的一些坑
date: 2018-2-19 8:32:07
tags: ["移动端","JavaScript"]
---

## 起点中文网demo_移动端 做时遇到的bug
### 一、移动端轮播
1.touchstart 手指触摸 == mousedown 
2.touchend 手指抬起 == mouseup
3.touchmove 手指抬起 == mousmove
touch事件  在 chrome的模拟器下，部分版本 通过on的方式来添加事件无效
所以在移动端一般都使用如下方式
addEventListener("事件名",函数,冒泡或捕获);
```
document.addEventListener('touchstart',function(ev){
    ev.preventDefault();
});
var box=document.getElementById("box");
box.addEventListener('touchstart',function(){
    this.innerHTML='手指按下了';
});
box.addEventListener('touchmove',function(){
    this.innerHTML='手指移动了';
});
box.addEventListener('touchend',function(){
    this.innerHTML='手指离开了';
});
```
参考[前端网](http://www.qdfuns.com/notes/37602/5901a1994c6f69d213da2aef82aa1d8d.html)
移动端事件demo http://ansonznl.coding.me/Mobile-demo/%E7%A7%BB%E5%8A%A8%E4%BA%8B%E4%BB%B601.html
### 二、滚动条
**scrollTop为滚动条在Y轴上的滚动距离。
clientHeight为内容可视区域的高度。
scrollHeight为内容可视区域的高度加上溢出（滚动）的距离。**
从这个三个属性的介绍就可以看出来，滚动条到底部的条件即为scrollTop + clientHeight == scrollHeight。
废话不多少说，赶紧上代码（兼容不同的浏览器）。
```
//滚动条在Y轴上的滚动距离
function getScrollTop(){
　　var scrollTop = 0, bodyScrollTop = 0, documentScrollTop = 0;
　　if(document.body){
　　　　bodyScrollTop = document.body.scrollTop;
　　}
　　if(document.documentElement){
　　　　documentScrollTop = document.documentElement.scrollTop;
　　}
　　scrollTop = (bodyScrollTop - documentScrollTop > 0) ? bodyScrollTop : documentScrollTop;
　　return scrollTop;
}
//文档的总高度
function getScrollHeight(){
　　var scrollHeight = 0, bodyScrollHeight = 0, documentScrollHeight = 0;
　　if(document.body){
　　　　bodyScrollHeight = document.body.scrollHeight;
　　}
　　if(document.documentElement){
　　　　documentScrollHeight = document.documentElement.scrollHeight;
　　}
　　scrollHeight = (bodyScrollHeight - documentScrollHeight > 0) ? bodyScrollHeight : documentScrollHeight;
　　return scrollHeight;
}
//浏览器视口的高度
function getWindowHeight(){
　　var windowHeight = 0;
　　if(document.compatMode == "CSS1Compat"){
　　　　windowHeight = document.documentElement.clientHeight;
　　}else{
　　　　windowHeight = document.body.clientHeight;
　　}
　　return windowHeight;
}
window.onscroll = function(){
　　if(getScrollTop() + getWindowHeight() == getScrollHeight()){
　　　　alert("you are in the bottom!");
　　}
};
```
### 三、修改input 中placeholder字体颜色
以前都不知道能修改，百度一下才知道是可以的
```
 ::-webkit-input-placeholder { /* WebKit browsers */
　　color:#999;
　　}
　　:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
　　color:#999;
　　}
　　::-moz-placeholder { /* Mozilla Firefox 19+ */
　　color:#999;
　　}
　　:-ms-input-placeholder { /* Internet Explorer 10+ */
　　color:#999;
　　}
```
### 四、清除a、button的默认跳转
比如说登录时，账号和密码不填时不能点登录，节省js判断，或者有时候不想让a标签跳转可以用到
```
<button disabled="disabled" id="btn">登录</button>
/* 添加disabled属性后不会提交数据 */
<a href="javascript:" class="borlenone phb_nav">风云榜</a>
/* 在a的href添加javascript:;属性后不会跳转 */
```
做完了起点中文网的移动端后对移动网页的制作有加深一些，对于js的运用也熟练了许多，自己也封装了一个选项卡方法，，对于html、css的一些属性更了解了，
总而言之收获恒很大。现在移动端浏览器兼容还是有点问题。
加油，
最后放上[起点中文网demo](https://ansonznl.coding.me/QiDian/)

**后续加：**
写大连罗森（移动端）的时候居然发现过了个年回来很多代码都生疏了，
在写的过程中发现一些问题，在此记录下来以防在犯。
- 做的时候主要使用rem布局，rem用熟练了以后确实方便很多，做的时候也遇到过一些问题，在此记录一下。
- 一个页面插入多个swiper
写的首页的时候，首页需要加两个轮播图，并且结构上不一样，我就引入了一个swiper。
问题：在写首页的时候遇到了一个问题，就是点击一个轮播图的按钮时候，另一个也跟着动，
思考：我就想，这肯定不行啊，然后晚上回去就开始研究，发现它其实就是class一样，所以调用的function一样，从而导致的2个轮播一起轮播，
解决方案：给第一个轮播的按钮重新命名一个新的class，并且调用同一个function，完美解决！
- img加宽高
这个写完后台测试时才发现的问题，导致前期给后台大哥填了很多麻烦，还是给img标签加上高和宽比较好。这样的话，图片显示出来就会按照设定好的尺寸，不会出现意外情况。但如果没有设定，很有可能会出现图片上边有白条，或者没有按照想要的效果显示，网站更新是换图片会出现问题。我碰到的就是没有加宽高，造成了图片下沉，上面出现白条。
网页中的img最好使用div包起来，或者把img的display属性设为block，可以消除img的默认边距
记忆比较深刻的就是这么两个问题，
最后放上演示地址（建议手机浏览）：http://zhangningle.gitee.io/m.luosen/